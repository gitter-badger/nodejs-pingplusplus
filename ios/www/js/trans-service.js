// Generated by CoffeeScript 1.8.0
bumblebee.service('TransService', function($rootScope, $http) {
  var current_index, service, transes;
  transes = [];
  current_index = 0;
  service = {
    init: function(user_id, callback) {
      return $http.get(glo_domain + ("trans/user/" + user_id + "/" + transes.length)).success(function(data) {
        _.each(data, function(el) {
          return transes.push(el);
        });
        if (transes.length) {
          service.setCurrent(current_index);
        }
        return callback();
      });
    },
    getAll: function() {
      return transes;
    },
    get: function(trans_id) {
      return _.findWhere(transes, {
        id: trans_id
      });
    },
    getCurrent: function() {
      if (transes.length) {
        return transes[current_index];
      }
    },
    getCurrentIndex: function() {
      return current_index;
    },
    setCurrent: function(index) {
      current_index = index;
      transes.forEach(function(el) {
        return el.current = false;
      });
      transes[index].current = true;
      transes[index].alert = false;
      return $rootScope.$broadcast('trans.update');
    },
    add: function(trans) {
      trans.alert = true;
      transes.unshift(trans);
      return $rootScope.$broadcast('trans.added');
    },
    upadte: function(trans) {
      var _trans;
      trans.alert = true;
      _trans = _.findWhere(transes, {
        id: trans.id
      });
      if (_trans) {
        if (_trans.current) {
          trans.current = true;
        }
        _trans = trans;
        $rootScope.$broadcast('trans.updated');
      }
    }
  };
  return service;
});

//# sourceMappingURL=trans-service.js.map
